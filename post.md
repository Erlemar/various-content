# Введение



Эта статья описывает небольшой самостоятельный проект по распознаванию рукописного ввода цифр. Вы сможете узнать, как сделать сделать практически с нуля следующее:

- создать простой сайт с использованием Flask и Bootstrap;

- разместить его на платформе Heroku;

- реализовать сохранение и загрузку данных на облаке Amazon s3;

- собрать собственный датасет;

- натренировать модели машинного обучения;

- сделать возможность дообучения моделей;

- затем запустить всё это;

Для полного понимания проекта необходимо знать как работает deep learning для распознавания изображений, иметь базовые знания о Flask и немного разбираться в HTML, JS и CSS.



## Немного обо мне

Я лишь около года занимаюсь машинным обучением и всем связанным с этим (до этого 4 года работал в консалтинге на внедрении ERP-систем). Для получения и развития навыков решил попробовать



## Зарождение идеи

Несколько месяцев назад я прошёл специализацию Яндекса и МФТИ на Coursera. У неё есть свой team в Slack, и в апреле там самоорганизовалась группа для прохождения Стенфордского курса cs231n. Как это происходило - отдельная история, но ближе к делу. Важной частью курса является самостоятельный проект (40% оценки для студентов), в котором предоставляется полная свобода действий. Я не хотел делать что-то серьёзное и потом писать про это статью ибо не видел в этом смысла, но всё же душа просила сделать что-то для достойного завершения курса. Примерно в это мне на глаза попался сайт https://tensorflow-mnist.herokuapp.com/ где можно нарисовать цифру и 2 сетки на Tensorflow мгновенно распознают её и покажут результат.



# Основная часть
Здесь я расскажу о том, что и как я делал, чтобы реализовать проект. Объяснения будут достаточно подробными, чтобы было можно их повторить, но некоторые совсем базовые вещи я буду описывать кратко или пропускать.


## Планирование проекта
Перед тем как приступать к чему-то большому стоит это что-то распланировать. По ходу дела будут выясняться новые подробности и план придётся скорректировать, но некое изначальное видение просто обязано быть.
1. Для любого проекта по машинному обучению одним из основополагающих моментов является вопрос о том, какие данные использовать и где их взять. Датасет MNIST активно используется в задачах распознавация цифр, и именно поэтому я не захотел его использовать. В интернете можно найти примеры подобных проектов, где модели натренированы на MNIST (например, https://github.com/sugyan/tensorflow-mnist), мне же хотелось сделать что-то новое. И, наконец, мне казалось, что многие из цифр в MNIST далеки от реальности - при просмотре датасета я встречал много таких вариантов, которые сложно представить в реальности (если только у человека совсем уж жуткий почерк). Плюс рисование цифр в браузере мышкой несколько отличается от их написания ручкой. Как следствие я решил собрать собственный датасет;
2. Следующий (а точнее одновременный) шаг - это создание сайта для сбора данных, а в дальнейшем - создание модифицирование сайта так, чтобы он мог давать предсказания. На тот момент у меня имелись базовые знания Flask, а также HTML, JS и CSS. Поэтому я и решил делать сайт на Flask, а в качестве хостинга была выбрана платформа Heroku, как позволяющая быстро и просто захостить маленький сайт.
3. Далее предстояло создать сами модели, которые должны делать основную работу. Этот этап казался самым простым, поскольку после cs231n имелся достаточный опыт создания архитектуры нейронных сетей для распознавания изображений. Предварительно хотелось сделать несколько архитектур, но в дальнейшем решил остановиться на двух - FNN и CNN. Кроме того, нужно было сделать возможность дотренировки этих моделей, и некоторые идеи на этот счёт у меня уже были;
4. После подготовки моделей следует придать сайту приличный вид, как-то отображать предсказания, дать возможность оценивать корректность ответа, немного описать функционал и сделать ряд других мелких и не очень вещей. На этапе планирования я не стал уделять много времени на размышления об этом, просто составил список;

## Сбор данных
На сбор данных у меня ушла чуть ли не половина всего времени, потраченного на проект. Дело в том, что я слабо был знаком, с тем, что надо было сделать, поэтому приходилось двигаться методом проб и ошибок.

### Создание первой версии сайта
Первый вариант сайта выглядел вот так: 

![](https://raw.githubusercontent.com/Erlemar/various-content/master/1.jpg?raw=true)

В нём была только самая базовая функциональность:

* канвас для рисования;
* радио-кнопки для выбора лейбла
* кнопки для сохранения картинок и очистки канваса;
* поле, в котором писалось успешно ли было сохранение;
* сохранение картинок на облаке Amazon;

Итак, теперь подробнее обо всём этом. Специально для статьи я сделал минимально рабочую версию сайта, на примере которой и буду рассказывать, как сделать вышеперечисленное: https://digits-little.herokuapp.com/

## Flask
Flask - питоновский фреймворк для создания сайтов. На официальном сайте есть отличное [введение](http://flask.pocoo.org/docs/0.12/quickstart/#quickstart). Есть разные способы использования Flask для получения и передачи информации, в этом проекте я использовал AJAX. AJAX даёт возможность "фонового" обмена данными между браузером и веб-сервером, это позволяет не перезагружать страницы каждый раз при передаче данных.

### Интеграция с Amazon s3



### Heroku



## FNN

Тренировка



## Bootstrap и дизайн сайта



## Дообучение FNN и модификации дизайна под это



## CNN

Тренировка

Дообучение



## Всякие улучшения.

Touch, MNIST, чистка кода (и облом с переменными в tf). Страницы с описанием проекта.



# Запуск проекта



## Слежение за точность.



# Заключение



## Существующие проблемы



## Планы на следующий проект



## Общее впечатление от проекта
